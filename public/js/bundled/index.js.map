{"mappings":"A,Q,sC,Q,yC,Q,8C,Q,6C,Q,2C,Q,8C,Q,4C,Q,uC,Q,wC,Q,sC,Q,0C,Q,sC,Q,0C,Q,0C,Q,wC,Q,wC,Q,0C,Q,4C,Q,uC,Q,oC,Q,wC,Q,sC,Q,wC,Q,wC,Q,8C,Q,0C,Q,yC,Q,wC,Q,wC,Q,wC,Q,8C,Q,0C,Q,wC,Q,8C,Q,0C,Q,wC,Q,gD,Q,wC,Q,yC,Q,qD,Q,qD,Q,kD,Q,uD,Q,sD,Q,2D,Q,kD,Q,sD,Q,8C,Q,yC,Q,4C,Q,4C,Q,uC,Q,wC,Q,sC,Q,sC,Q,8C,Q,kD,Q,8C,Q,gD,Q,sC,Q,qC,Q,oC,Q,wC,Q,sC,Q,sD,Q,uC,Q,uC,Q,gD,Q,4C,Q,+C,Q,kD,Q,iD,Q,2C,Q,yC,Q,8C,Q,iD,Q,2C,Q,yC,Q,oC,Q,+B,I,E,Q,S,E,Q,W,S,E,C,E,O,G,E,U,C,E,O,C,C,CGAA,MAAM,EAAY,KAChB,IAAM,EAAK,SAAS,aAAa,CAAC,UAE9B,GAAI,EAAG,aAAa,CAAC,WAAW,CAAC,EACvC,EAGa,EAAY,CAAC,EAAM,KAC9B,IAEA,IAAM,EAAS,CAAC,yBAAyB,EAAE,EAAK,EAAE,EAAE,EAAI,MAAM,CAAC,CAC/D,SAAS,aAAa,CAAC,QAAQ,kBAAkB,CAAC,aAAc,GAEhE,OAAO,UAAU,CAAC,EAAW,IAC/B,EDXa,EAAQ,MAAO,EAAO,KACjC,GAAI,CACF,IAAM,EAAM,MAAM,AAAA,EAAA,GAAM,CACtB,OAAQ,OACR,IAAK,8BACL,KAAM,CACJ,MAAA,EACA,SAAA,CACF,CACF,EAEwB,CAAA,YAApB,EAAI,IAAI,CAAC,MAAM,GACjB,AAAA,EAAU,UAAW,2BACrB,OAAO,UAAU,CAAC,KAChB,SAAS,MAAM,CAAC,IAClB,EAAG,MAEP,CAAE,MAAO,EAAK,CACZ,AAAA,EAAU,QAAS,EAAI,QAAQ,CAAC,IAAI,CAAC,OAAO,CAC9C,CACF,EAEa,EAAS,UACpB,GAAI,CACF,IAAM,EAAM,MAAM,AAAA,EAAA,GAAM,CACtB,OAAQ,MACR,IAAK,8BACP,EAGwB,CAAA,YAApB,EAAI,IAAI,CAAC,MAAM,EACjB,SAAS,MAAM,CAAC,CAAA,EAEpB,CAAE,MAAO,EAAK,CACZ,AAAA,EAAU,QAAS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","sources":["<anon>","public/js/index.js","public/js/login.js","public/js/alerts.js","public/js/leaflet.js","public/js/updateSettings.js","public/js/stripe.js"],"sourcesContent":["require(\"core-js/modules/es.regexp.flags.js\");\nrequire(\"core-js/modules/es.typed-array.set.js\");\nrequire(\"core-js/modules/esnext.array.last-index.js\");\nrequire(\"core-js/modules/esnext.array.last-item.js\");\nrequire(\"core-js/modules/esnext.composite-key.js\");\nrequire(\"core-js/modules/esnext.composite-symbol.js\");\nrequire(\"core-js/modules/esnext.map.delete-all.js\");\nrequire(\"core-js/modules/esnext.map.every.js\");\nrequire(\"core-js/modules/esnext.map.filter.js\");\nrequire(\"core-js/modules/esnext.map.find.js\");\nrequire(\"core-js/modules/esnext.map.find-key.js\");\nrequire(\"core-js/modules/esnext.map.from.js\");\nrequire(\"core-js/modules/esnext.map.group-by.js\");\nrequire(\"core-js/modules/esnext.map.includes.js\");\nrequire(\"core-js/modules/esnext.map.key-by.js\");\nrequire(\"core-js/modules/esnext.map.key-of.js\");\nrequire(\"core-js/modules/esnext.map.map-keys.js\");\nrequire(\"core-js/modules/esnext.map.map-values.js\");\nrequire(\"core-js/modules/esnext.map.merge.js\");\nrequire(\"core-js/modules/esnext.map.of.js\");\nrequire(\"core-js/modules/esnext.map.reduce.js\");\nrequire(\"core-js/modules/esnext.map.some.js\");\nrequire(\"core-js/modules/esnext.map.update.js\");\nrequire(\"core-js/modules/esnext.math.clamp.js\");\nrequire(\"core-js/modules/esnext.math.deg-per-rad.js\");\nrequire(\"core-js/modules/esnext.math.degrees.js\");\nrequire(\"core-js/modules/esnext.math.fscale.js\");\nrequire(\"core-js/modules/esnext.math.iaddh.js\");\nrequire(\"core-js/modules/esnext.math.imulh.js\");\nrequire(\"core-js/modules/esnext.math.isubh.js\");\nrequire(\"core-js/modules/esnext.math.rad-per-deg.js\");\nrequire(\"core-js/modules/esnext.math.radians.js\");\nrequire(\"core-js/modules/esnext.math.scale.js\");\nrequire(\"core-js/modules/esnext.math.seeded-prng.js\");\nrequire(\"core-js/modules/esnext.math.signbit.js\");\nrequire(\"core-js/modules/esnext.math.umulh.js\");\nrequire(\"core-js/modules/esnext.number.from-string.js\");\nrequire(\"core-js/modules/esnext.observable.js\");\nrequire(\"core-js/modules/esnext.promise.try.js\");\nrequire(\"core-js/modules/esnext.reflect.define-metadata.js\");\nrequire(\"core-js/modules/esnext.reflect.delete-metadata.js\");\nrequire(\"core-js/modules/esnext.reflect.get-metadata.js\");\nrequire(\"core-js/modules/esnext.reflect.get-metadata-keys.js\");\nrequire(\"core-js/modules/esnext.reflect.get-own-metadata.js\");\nrequire(\"core-js/modules/esnext.reflect.get-own-metadata-keys.js\");\nrequire(\"core-js/modules/esnext.reflect.has-metadata.js\");\nrequire(\"core-js/modules/esnext.reflect.has-own-metadata.js\");\nrequire(\"core-js/modules/esnext.reflect.metadata.js\");\nrequire(\"core-js/modules/esnext.set.add-all.js\");\nrequire(\"core-js/modules/esnext.set.delete-all.js\");\nrequire(\"core-js/modules/esnext.set.difference.js\");\nrequire(\"core-js/modules/esnext.set.every.js\");\nrequire(\"core-js/modules/esnext.set.filter.js\");\nrequire(\"core-js/modules/esnext.set.find.js\");\nrequire(\"core-js/modules/esnext.set.from.js\");\nrequire(\"core-js/modules/esnext.set.intersection.js\");\nrequire(\"core-js/modules/esnext.set.is-disjoint-from.js\");\nrequire(\"core-js/modules/esnext.set.is-subset-of.js\");\nrequire(\"core-js/modules/esnext.set.is-superset-of.js\");\nrequire(\"core-js/modules/esnext.set.join.js\");\nrequire(\"core-js/modules/esnext.set.map.js\");\nrequire(\"core-js/modules/esnext.set.of.js\");\nrequire(\"core-js/modules/esnext.set.reduce.js\");\nrequire(\"core-js/modules/esnext.set.some.js\");\nrequire(\"core-js/modules/esnext.set.symmetric-difference.js\");\nrequire(\"core-js/modules/esnext.set.union.js\");\nrequire(\"core-js/modules/esnext.string.at.js\");\nrequire(\"core-js/modules/esnext.string.code-points.js\");\nrequire(\"core-js/modules/esnext.symbol.dispose.js\");\nrequire(\"core-js/modules/esnext.symbol.observable.js\");\nrequire(\"core-js/modules/esnext.symbol.pattern-match.js\");\nrequire(\"core-js/modules/esnext.weak-map.delete-all.js\");\nrequire(\"core-js/modules/esnext.weak-map.from.js\");\nrequire(\"core-js/modules/esnext.weak-map.of.js\");\nrequire(\"core-js/modules/esnext.weak-set.add-all.js\");\nrequire(\"core-js/modules/esnext.weak-set.delete-all.js\");\nrequire(\"core-js/modules/esnext.weak-set.from.js\");\nrequire(\"core-js/modules/esnext.weak-set.of.js\");\nrequire(\"core-js/modules/web.immediate.js\");\nrequire(\"regenerator-runtime/runtime\");\nvar $c36S4$axios = require(\"axios\");\nvar $c36S4$leaflet = require(\"leaflet\");\n\n\nfunction $parcel$interopDefault(a) {\n  return a && a.__esModule ? a.default : a;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst $ebad8d90ec8b34bd$var$hideAlert = ()=>{\n    const el = document.querySelector(\".alert\");\n    // const el = document.getElementsByClassName('alert')[0];\n    if (el) el.parentElement.removeChild(el);\n};\nconst $ebad8d90ec8b34bd$export$de026b00723010c1 = (type, msg)=>{\n    $ebad8d90ec8b34bd$var$hideAlert();\n    const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\n    document.querySelector(\"body\").insertAdjacentHTML(\"afterbegin\", markup);\n    window.setTimeout($ebad8d90ec8b34bd$var$hideAlert, 5000);\n};\n\n\nconst $87077f1c856c363b$export$596d806903d1f59e = async (email, password)=>{\n    try {\n        const res = await (0, ($parcel$interopDefault($c36S4$axios)))({\n            method: \"POST\",\n            url: \"        /api/v1/users/login\",\n            data: {\n                email: email,\n                password: password\n            }\n        });\n        if (res.data.status === \"success\") {\n            (0, $ebad8d90ec8b34bd$export$de026b00723010c1)(\"success\", \"Logged in successfully!\");\n            window.setTimeout(()=>{\n                location.assign(\"/\");\n            }, 1500);\n        }\n    } catch (err) {\n        (0, $ebad8d90ec8b34bd$export$de026b00723010c1)(\"error\", err.response.data.message);\n    }\n};\nconst $87077f1c856c363b$export$a0973bcfe11b05c9 = async ()=>{\n    try {\n        const res = await (0, ($parcel$interopDefault($c36S4$axios)))({\n            method: \"GET\",\n            url: \"        /api/v1/users/logout\"\n        });\n        // Let's reload the page programmatically here on the client side\n        if (res.data.status === \"success\") location.reload(true); // NOTE : important to set the `forceReload: true` from Server, not from Browser Cache\n    } catch (err) {\n        (0, $ebad8d90ec8b34bd$export$de026b00723010c1)(\"error\", \"Error logging out! Try Again!\");\n    }\n};\n\n\n\nconst $4714f05611a40e89$export$4c5dd147b21b9176 = (locations)=>{\n    // adding the map to the `div#map`\n    // set up the map without zoom Control`\n    const map = (0, ($parcel$interopDefault($c36S4$leaflet))).map(\"map\", {\n        zoomControl: false,\n        dragging: false,\n        doubleClickZoom: false\n    });\n    // adding a tile to the map, the default choice in the Leaflet Documentation\n    (0, ($parcel$interopDefault($c36S4$leaflet))).tileLayer(\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\", {\n        attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n    }).addTo(map);\n    // Create icon using the image provided by Jonas\n    const greenIcon = (0, ($parcel$interopDefault($c36S4$leaflet))).icon({\n        iconUrl: \"/img/pin.png\",\n        iconSize: [\n            32,\n            40\n        ],\n        iconAnchor: [\n            16,\n            45\n        ],\n        popupAnchor: [\n            0,\n            -50\n        ]\n    });\n    // Add locations to the map\n    const points = [];\n    locations.forEach((loc)=>{\n        // Create points\n        points.push([\n            loc.coordinates[1],\n            loc.coordinates[0]\n        ]);\n        // Add markers\n        (0, ($parcel$interopDefault($c36S4$leaflet))).marker([\n            loc.coordinates[1],\n            loc.coordinates[0]\n        ], {\n            icon: greenIcon\n        }).addTo(map)// Add popup\n        .bindPopup(`<h2>Day ${loc.day}: ${loc.description}</h2>`, {\n            autoClose: false\n        }).openPopup();\n    });\n    // Set map bounds to include current location\n    const bounds = (0, ($parcel$interopDefault($c36S4$leaflet))).latLngBounds(points).pad(0.5);\n    map.fitBounds(bounds);\n    // Disable scroll on map\n    map.scrollWheelZoom.disable();\n};\n\n\n\n\nconst $cd71c5380962b14e$export$f558026a994b6051 = async (data, type)=>{\n    try {\n        const url = type === \"password\" ? \"/api/v1/users/updateMyPassword\" : \"/api/v1/users/updateMe\";\n        const res = await (0, ($parcel$interopDefault($c36S4$axios)))({\n            method: \"PATCH\",\n            url: url,\n            data: data\n        });\n        if (res.data.status === \"success\") (0, $ebad8d90ec8b34bd$export$de026b00723010c1)(\"success\", `${type.toUpperCase()} saved successfully!`);\n    } catch (err) {\n        (0, $ebad8d90ec8b34bd$export$de026b00723010c1)(\"error\", err.response.data.message);\n    }\n};\n\n\n/* eslint-disable */ \n\nconst $bb97821d2da99c94$var$stripe = Stripe(\"pk_test_51Paf8EHkMupqreso7gTbWBTw6HfkGouzIkviV611JS1pt7F2X0DuOiCJNnKtDzvBRWiU4e86nOP5z1hp3R1OJuxW008nix8yzO\");\nconst $bb97821d2da99c94$export$8d5bdbf26681c0c2 = async (tourId)=>{\n    try {\n        // 1) Get Checkout Session from API\n        const session = await (0, ($parcel$interopDefault($c36S4$axios)))(`/api/v1/bookings/checkout-session/${tourId}`);\n        // 2) Create Checkout Form + Charge credit card\n        await $bb97821d2da99c94$var$stripe.redirectToCheckout({\n            sessionId: session.data.session.id\n        });\n    } catch (err) {\n        console.log(err);\n        (0, $ebad8d90ec8b34bd$export$de026b00723010c1)(\"error\", err);\n    }\n};\n\n\n// DOM ELEMENTS\nconst $037ca8a395e4484b$var$leaflet = document.getElementById(\"map\");\nconst $037ca8a395e4484b$var$loginForm = document.querySelector(\".form--login \");\nconst $037ca8a395e4484b$var$logOutBtn = document.querySelector(\".nav__el--logout\");\nconst $037ca8a395e4484b$var$userDataForm = document.querySelector(\".form-user-data\");\nconst $037ca8a395e4484b$var$userPasswordForm = document.querySelector(\".form-user-password\");\nconst $037ca8a395e4484b$var$bookBtn = document.querySelector(\"#book-tour\");\n// DELEGATION\nif ($037ca8a395e4484b$var$leaflet) {\n    const locations = JSON.parse($037ca8a395e4484b$var$leaflet.dataset.locations);\n    (0, $4714f05611a40e89$export$4c5dd147b21b9176)(locations);\n}\nif ($037ca8a395e4484b$var$loginForm) $037ca8a395e4484b$var$loginForm.addEventListener(\"submit\", (e)=>{\n    e.preventDefault();\n    const email = document.getElementById(\"email\").value;\n    const password = document.getElementById(\"password\").value;\n    (0, $87077f1c856c363b$export$596d806903d1f59e)(email, password);\n});\nif ($037ca8a395e4484b$var$logOutBtn) $037ca8a395e4484b$var$logOutBtn.addEventListener(\"click\", (0, $87077f1c856c363b$export$a0973bcfe11b05c9));\nif ($037ca8a395e4484b$var$userDataForm) {\n    const TEST_DEBUG = false;\n    const photoElem = document.getElementById(\"photo\");\n    photoElem.addEventListener(\"change\", (e)=>{\n        const [newFile] = e.target.files;\n        if (newFile && newFile.type.startsWith(\"image\")) {\n            const formUserPhoto = document.querySelector(\".form__user-photo\");\n            formUserPhoto.src = URL.createObjectURL(newFile);\n        }\n    });\n    $037ca8a395e4484b$var$userDataForm.addEventListener(\"submit\", async (e)=>{\n        e.preventDefault();\n        document.getElementById(\"btn--saveSettings\").textContent = \"Updating...\";\n        const form = new FormData();\n        form.append(\"name\", document.getElementById(\"name\").value);\n        form.append(\"email\", document.getElementById(\"email\").value);\n        form.append(\"photo\", photoElem.files[0]);\n        await (0, $cd71c5380962b14e$export$f558026a994b6051)(form, \"data\");\n        document.getElementById(\"btn--saveSettings\").textContent = \"Save Settings\";\n    });\n}\nif ($037ca8a395e4484b$var$userPasswordForm) $037ca8a395e4484b$var$userPasswordForm.addEventListener(\"submit\", async (e)=>{\n    e.preventDefault();\n    document.querySelector(\".btn--save-password\").textContent = \"Updating...\";\n    const passwordCurrent = document.getElementById(\"password-current\").value;\n    const password = document.getElementById(\"password\").value;\n    const passwordConfirm = document.getElementById(\"password-confirm\").value;\n    await (0, $cd71c5380962b14e$export$f558026a994b6051)({\n        passwordCurrent: passwordCurrent,\n        password: password,\n        passwordConfirm: passwordConfirm\n    }, \"password\");\n    document.querySelector(\".btn--save-password\").textContent = \"Save password\";\n    document.getElementById(\"password-current\").value = \"\";\n    document.getElementById(\"password\").value = \"\";\n    document.getElementById(\"password-confirm\").value = \"\";\n});\nif ($037ca8a395e4484b$var$bookBtn) $037ca8a395e4484b$var$bookBtn.addEventListener(\"click\", (e)=>{\n    e.target.textContent = \"Processing...\";\n    const { tourId: tourId } = e.target.dataset;\n    (0, $bb97821d2da99c94$export$8d5bdbf26681c0c2)(tourId);\n// e.target.textContent = 'Book Tour Now!';\n});\n\n\n//# sourceMappingURL=index.js.map\n","import 'core-js';\r\nimport 'regenerator-runtime/runtime';\r\n\r\nimport { login, logout } from './login';\r\nimport { displayMap } from './leaflet';\r\nimport { updateSettings } from './updateSettings';\r\nimport { bookTour } from './stripe';\r\n\r\n// DOM ELEMENTS\r\nconst leaflet = document.getElementById('map');\r\nconst loginForm = document.querySelector('.form--login ');\r\nconst logOutBtn = document.querySelector('.nav__el--logout');\r\nconst userDataForm = document.querySelector('.form-user-data');\r\nconst userPasswordForm = document.querySelector('.form-user-password');\r\nconst bookBtn = document.querySelector('#book-tour');\r\n\r\n// DELEGATION\r\nif (leaflet) {\r\n  const locations = JSON.parse(leaflet.dataset.locations);\r\n  displayMap(locations);\r\n}\r\n\r\nif (loginForm) {\r\n  loginForm.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n    const email = document.getElementById('email').value;\r\n    const password = document.getElementById('password').value;\r\n    login(email, password);\r\n  });\r\n}\r\n\r\nif (logOutBtn) {\r\n  logOutBtn.addEventListener('click', logout);\r\n}\r\n\r\nif (userDataForm) {\r\n  const TEST_DEBUG = false;\r\n\r\n  const photoElem = document.getElementById('photo');\r\n\r\n  photoElem.addEventListener('change', (e) => {\r\n    const [newFile] = e.target.files;\r\n\r\n    if (newFile && newFile.type.startsWith('image')) {\r\n      const formUserPhoto = document.querySelector('.form__user-photo');\r\n      formUserPhoto.src = URL.createObjectURL(newFile);\r\n    }\r\n  });\r\n\r\n  userDataForm.addEventListener('submit', async (e) => {\r\n    e.preventDefault();\r\n    document.getElementById('btn--saveSettings').textContent = 'Updating...';\r\n\r\n    const form = new FormData();\r\n    form.append('name', document.getElementById('name').value);\r\n    form.append('email', document.getElementById('email').value);\r\n    form.append('photo', photoElem.files[0]);\r\n\r\n    await updateSettings(form, 'data');\r\n\r\n    document.getElementById('btn--saveSettings').textContent = 'Save Settings';\r\n  });\r\n}\r\n\r\nif (userPasswordForm) {\r\n  userPasswordForm.addEventListener('submit', async (e) => {\r\n    e.preventDefault();\r\n    document.querySelector('.btn--save-password').textContent = 'Updating...';\r\n    const passwordCurrent = document.getElementById('password-current').value;\r\n    const password = document.getElementById('password').value;\r\n    const passwordConfirm = document.getElementById('password-confirm').value;\r\n\r\n    await updateSettings(\r\n      { passwordCurrent, password, passwordConfirm },\r\n      'password',\r\n    );\r\n\r\n    document.querySelector('.btn--save-password').textContent = 'Save password';\r\n    document.getElementById('password-current').value = '';\r\n    document.getElementById('password').value = '';\r\n    document.getElementById('password-confirm').value = '';\r\n  });\r\n}\r\n\r\nif (bookBtn) {\r\n  bookBtn.addEventListener('click', (e) => {\r\n    e.target.textContent = 'Processing...';\r\n    const { tourId } = e.target.dataset;\r\n    bookTour(tourId);\r\n    // e.target.textContent = 'Book Tour Now!';\r\n  });\r\n}\r\n","import axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\nexport const login = async (email, password) => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'POST',\r\n      url: '        /api/v1/users/login',\r\n      data: {\r\n        email,\r\n        password,\r\n      },\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', 'Logged in successfully!');\r\n      window.setTimeout(() => {\r\n        location.assign('/');\r\n      }, 1500);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};\r\n\r\nexport const logout = async () => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'GET',\r\n      url: '        /api/v1/users/logout',\r\n    });\r\n\r\n    // Let's reload the page programmatically here on the client side\r\n    if (res.data.status === 'success') {\r\n      location.reload(true); // NOTE : important to set the `forceReload: true` from Server, not from Browser Cache\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', 'Error logging out! Try Again!');\r\n  }\r\n};\r\n","const hideAlert = () => {\r\n  const el = document.querySelector('.alert');\r\n  // const el = document.getElementsByClassName('alert')[0];\r\n  if (el) el.parentElement.removeChild(el);\r\n};\r\n\r\n// type is either 'success' or 'error'\r\nexport const showAlert = (type, msg) => {\r\n  hideAlert();\r\n\r\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\r\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\r\n\r\n  window.setTimeout(hideAlert, 5000);\r\n};\r\n","import L from 'leaflet';\r\n\r\nexport const displayMap = (locations) => {\r\n  // adding the map to the `div#map`\r\n  // set up the map without zoom Control`\r\n  const map = L.map('map', {\r\n    zoomControl: false,\r\n    dragging: false,\r\n    doubleClickZoom: false,\r\n  });\r\n\r\n  // adding a tile to the map, the default choice in the Leaflet Documentation\r\n  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n    attribution:\r\n      '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\r\n  }).addTo(map);\r\n\r\n  // Create icon using the image provided by Jonas\r\n  const greenIcon = L.icon({\r\n    iconUrl: '/img/pin.png',\r\n    iconSize: [32, 40], // size of the icon\r\n    iconAnchor: [16, 45], // point of the icon which will correspond to marker's location\r\n    popupAnchor: [0, -50], // point from which the popup should open relative to the iconAnchor\r\n  });\r\n\r\n  // Add locations to the map\r\n  const points = [];\r\n  locations.forEach((loc) => {\r\n    // Create points\r\n    points.push([loc.coordinates[1], loc.coordinates[0]]);\r\n\r\n    // Add markers\r\n    L.marker([loc.coordinates[1], loc.coordinates[0]], { icon: greenIcon })\r\n      .addTo(map)\r\n      // Add popup\r\n      .bindPopup(`<h2>Day ${loc.day}: ${loc.description}</h2>`, {\r\n        autoClose: false,\r\n      })\r\n      .openPopup();\r\n  });\r\n\r\n  // Set map bounds to include current location\r\n  const bounds = L.latLngBounds(points).pad(0.5);\r\n  map.fitBounds(bounds);\r\n\r\n  // Disable scroll on map\r\n  map.scrollWheelZoom.disable();\r\n};\r\n","import axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\n// `type` is either `'data'` or  `'password'`\r\nexport const updateSettings = async (data, type) => {\r\n  try {\r\n    const url =\r\n      type === 'password'\r\n        ? '/api/v1/users/updateMyPassword'\r\n        : '/api/v1/users/updateMe';\r\n\r\n    const res = await axios({\r\n      method: 'PATCH',\r\n      url,\r\n      data,\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', `${type.toUpperCase()} saved successfully!`);\r\n      // window.setTimeout(() => {\r\n      //   location.assign('/me');\r\n      // }, 1500);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};\r\n","/* eslint-disable */\r\nimport axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\nconst stripe = Stripe(\r\n  'pk_test_51Paf8EHkMupqreso7gTbWBTw6HfkGouzIkviV611JS1pt7F2X0DuOiCJNnKtDzvBRWiU4e86nOP5z1hp3R1OJuxW008nix8yzO',\r\n);\r\n\r\nexport const bookTour = async (tourId) => {\r\n  try {\r\n    // 1) Get Checkout Session from API\r\n    const session = await axios(`/api/v1/bookings/checkout-session/${tourId}`);\r\n\r\n    // 2) Create Checkout Form + Charge credit card\r\n    await stripe.redirectToCheckout({\r\n      sessionId: session.data.session.id,\r\n    });\r\n  } catch (err) {\r\n    console.log(err);\r\n    showAlert('error', err);\r\n  }\r\n};\r\n"],"names":["require","$c36S4$axios","$c36S4$leaflet","$parcel$interopDefault","a","__esModule","default","$ebad8d90ec8b34bd$var$hideAlert","el","document","querySelector","parentElement","removeChild","$ebad8d90ec8b34bd$export$de026b00723010c1","type","msg","markup","insertAdjacentHTML","window","setTimeout","$87077f1c856c363b$export$596d806903d1f59e","email","password","res","method","url","data","status","location","assign","err","response","message","$87077f1c856c363b$export$a0973bcfe11b05c9","reload","$cd71c5380962b14e$export$f558026a994b6051","toUpperCase","$bb97821d2da99c94$var$stripe","Stripe","$bb97821d2da99c94$export$8d5bdbf26681c0c2","tourId","session","redirectToCheckout","sessionId","id","console","log","$037ca8a395e4484b$var$leaflet","getElementById","$037ca8a395e4484b$var$loginForm","$037ca8a395e4484b$var$logOutBtn","$037ca8a395e4484b$var$userDataForm","$037ca8a395e4484b$var$userPasswordForm","$037ca8a395e4484b$var$bookBtn","locations","map","zoomControl","dragging","doubleClickZoom","tileLayer","attribution","addTo","greenIcon","icon","iconUrl","iconSize","iconAnchor","popupAnchor","points","forEach","loc","push","coordinates","marker","bindPopup","day","description","autoClose","openPopup","bounds","latLngBounds","pad","fitBounds","scrollWheelZoom","disable","JSON","parse","dataset","addEventListener","e","preventDefault","value","photoElem","newFile","target","files","startsWith","formUserPhoto","src","URL","createObjectURL","textContent","form","FormData","append","passwordCurrent","passwordConfirm"],"version":3,"file":"index.js.map"}